<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"/>
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" ></script>
        <script src="https://apis.mapmyindia.com/advancedmaps/v1/YTQ3MzIyMGUtMTJlMC00Yjg4LWE5ZDgtMGMyZDUxMWM2YWFm/map_load?v=1.5&vectorLayer"></script>
        <style>
            #map{
                height: 80vh;
                width: 80%;
            }    
        </style>
    </head>
    <body onload="Auth_token_generate();">
        <div id="mapid" style="width: 90%; height: 90vh;"></div>
        <button onclick="autosuggest();">autosuggest</button>
	<button onclick="autosuggest_pre();">Autosuggest Pre Prod</button>
	<button onclick="mgis_covid_stats();">mgis covid stats</button>
	<button onclick="covid_layer_api();">Covid Layers API</button>
	<button onclick="text_search();">Text_Search</button>
	<button onclick="eLoc();">eLoc</button>
        <button onclick="geocoding();">geocoding</button>
	<button onclick="geocoding_pre();">geocoding pre prod</button>
	<button onclick="nearby();">nearby</button>
	<button onclick="nearby_pre();">nearby pre prod</button>
        <button onclick="rev_geocode();">rev_geocode</button>
	<button onclick="route_adv();">route_adv</button>
	<button onclick="route_eta();">route_eta</button>
	<button onclick="route_traffic();">route_traffic</button>
        <button onclick="Many_to_Many_distance_matrix();">Many_to_Many_distance_matrix</button>
        <button onclick="distance_matrix();">distance_matrix</button>
	<button onclick="distance_matrix_eta();">distance_matrix_eta</button>
	<button onclick="distance_matrix_traffic();">distance_matrix_traffic</button>
        <button onclick="woodpecker();">Address_Standardization_API</button>
        
        <!-- // logic -->
        <script>

        map = new MapmyIndia.Map('mapid', {
                    center: [28.61, 77.23],
                    zoom: 9,
                    zoomControl: true,
                });
            var token;
            function jsonp(url, callback) {
                const callbackName = 'jsonp_callback_' + Math.round(100000 * Math.random());
                const script = document.createElement('script');
                script.src = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + callbackName;
                document.body.appendChild(script);
                window[callbackName] = function(data) {
                    delete window[callbackName];
                    document.body.removeChild( script );
                    callback(data);
                };
            }
            
            // token generating
            function Auth_token_generate(){
                $.ajax({
                    data: {
                    "grant_type": "client_credentials",
                    "client_id": "YTQ3MzIyMGUtMTJlMC00Yjg4LWE5ZDgtMGMyZDUxMWM2YWFm",
                    "client_secret": "YTQ3MzIyMGUtMTJlMC00Yjg4LWE5ZDgtMGMyZDUxMWM2YWFm"
                    },
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                    },
                    method: 'POST',
                    crossDomain: true, 
                    async: true,
                    url: 'https://outpost.mapmyindia.com/api/security/oauth/token',
                    error: function (data) {
                        console.log(data);
                        alert('An error has occurred');
                    },
                    success : function (data) {
                        token = data.access_token;
						console.log(token);
                    }
                });    
            }

            // call autosuggest api
            function autosuggest(){
                jsonp('https://atlas.mapmyindia.com/api/places/search/json?query=delhi&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	
	    // call autosuggest Pre Prod api
            function autosuggest_pre(){
                jsonp('https://atlasweb.mapmyindia.in/api/v4.4/places/search/json?query=mapmyindia&location=28.5507160000001,77.2689280000001&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
		
	    // call mGIS Covid Stats api
            function mgis_covid_stats(){
                jsonp('https://mgis.mapmyindia.in/getCovidStats?admin=district&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	
	    // call Covid Layer api
            function covid_layer_api(){
                jsonp('https://atlasweb.mapmyindia.in/api/v1.0.2/places/layers/json?keywords=HSPTMT;HSPCOV;HSPTST;HSPSCC;HSPTMT;FODHNG;HOTNST;CLIFVR;TMPRSN&eLoc=MMI000&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	    
	    // call text_search api
            function text_search(){
                jsonp('https://atlas.mapmyindia.com/api/places/textsearch/json?query=ITC Maurya, New Delhi&region=ind&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	
	    // call eLoc api
            function eLoc(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/YTQ3MzIyMGUtMTJlMC00Yjg4LWE5ZDgtMGMyZDUxMWM2YWFm/place_detail?place_id=MMI000', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }

            // call geocoding api
            function geocoding(){
                jsonp('https://atlas.mapmyindia.com/api/places/geocode?address=mapmyindia 237 okhla phase 3&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }

            // call geocoding pre prod api
            function geocoding_pre(){
                jsonp('https://devatlas.mapmyindia.in/api/places/geocode/v3.7.2?address=P-19, GREEN PARK EXTENSION, NEW DELHI,110016,DELHI&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	    
	    // call nearby api
            function nearby(){
                jsonp('https://atlas.mapmyindia.com/api/places/nearby/json?keywords=RCNAUS&refLocation=28.550759,77.268937&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	    
            // call nearby pre prod api
            function nearby_pre(){
                jsonp('https://atlasweb.mapmyindia.in/api/v4.4/places/nearby/json?refLocation=28.558460919432065,77.27203937290443&keywords=coffee&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }

            // call rev_geocode api
            function rev_geocode(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/YTQ3MzIyMGUtMTJlMC00Yjg4LWE5ZDgtMGMyZDUxMWM2YWFm/rev_geocode?lat=26.5645&lng=85.9914', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }

	    // call Route adv api
            function route_adv(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/'+token+'/route_adv/driving/77.131123,28.552413;77.113091,28.544649;77.227434,28.610981;77.22337245941164,28.606790894017795;77.2454654,28.13435446?steps=false&rtype=0&geometries=polyline&region=IND&alternatives=1', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	    // call Route eta api
            function route_eta(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/'+token+'/route_eta/driving/77.131123,28.552413;77.113091,28.544649;77.227434,28.610981;77.22337245941164,28.606790894017795;77.2454654,28.13435446?steps=false&rtype=0&geometries=polyline&region=IND&alternatives=1', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	    // call Route traffic api
            function route_traffic(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/'+token+'/route_eta/driving/77.131123,28.552413;77.113091,28.544649;77.227434,28.610981;77.22337245941164,28.606790894017795;77.2454654,28.13435446?steps=false&rtype=0&geometries=polyline&region=IND&alternatives=1', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
		
            // call Many_to_Many_distance_matrix api
            function Many_to_Many_distance_matrix(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/YTQ3MzIyMGUtMTJlMC00Yjg4LWE5ZDgtMGMyZDUxMWM2YWFm/distance_matrix/driving/77.983936,28.255904;77.05993,28.487555;77.15993,28.587555;77.264997,28.554534?sources=0;1&destinations=2;3', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }

            // call distance_matrix api
            function distance_matrix(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/'+token+'/distance_matrix/driving/90.33687,23.470314;90.379249,23.497178;90.497009,23.546286?rtype=1&region=bgd', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
	    
	    // call distance_matrix_eta api
            function distance_matrix_eta(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/'+token+'/distance_matrix_eta/driving/90.33687,23.470314;90.379249,23.497178;90.497009,23.546286?rtype=1&region=bgd', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
		
	    // call distance_matrix_traffic api
            function distance_matrix_traffic(){
                jsonp('https://apis.mapmyindia.com/advancedmaps/v1/'+token+'/distance_matrix_traffic/driving/90.33687,23.470314;90.379249,23.497178;90.497009,23.546286?rtype=1&region=bgd', function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }

            // Address Standardization API
            function woodpecker(){
                jsonp('https://atlas.mapmyindia.com/api/places/woodpecker?address=mapmyindia 237 okhla phase 3&access_token='+token, function(data) {
                    console.log(data);
                    alert(JSON.stringify(data));
                });
            }
            
        </script>
    </body>
</html>
